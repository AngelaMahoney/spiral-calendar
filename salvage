
# Week sections
weekgroup = doc.createElement('g')
setAttributesByDict(weekgroup, { 'stroke':'none', 'fill':'rgb(220,220,220)'})

d = startDate
while d < endDate:
    # Draw a section beginning at d, and ending before the next Sunday -
    # but not extending beyond the end date.
    start = d.weekday()
    nextSunday = min(d + timedelta(7 - start), endDate)
    weekgroup.appendChild(spiral.section(d, nextSunday, 0, 1))
    # We've drawn a section, so the next week is left white, and our next
    # section starts at the third week after d.
    d = d - timedelta(start) + timedelta(14)

